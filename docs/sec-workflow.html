<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 2 Trade data Workflow | Fishery: Trade Module</title>
  <meta name="description" content="Fisheries Trade Documentation">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 2 Trade data Workflow | Fishery: Trade Module" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Fisheries Trade Documentation" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Trade data Workflow | Fishery: Trade Module" />
  
  <meta name="twitter:description" content="Fisheries Trade Documentation" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="sec-intro.html">
<link rel="next" href="outlier-detection.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.5/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="ess.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="sec-intro.html"><a href="sec-intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="sec-workflow.html"><a href="sec-workflow.html"><i class="fa fa-check"></i><b>2</b> Trade data Workflow</a><ul>
<li class="chapter" data-level="2.1" data-path="sec-workflow.html"><a href="sec-workflow.html#get-started-data"><i class="fa fa-check"></i><b>2.1</b> Get started data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="outlier-detection.html"><a href="outlier-detection.html"><i class="fa fa-check"></i><b>3</b> Outlier Detection</a><ul>
<li class="chapter" data-level="3.1" data-path="outlier-detection.html"><a href="outlier-detection.html#data"><i class="fa fa-check"></i><b>3.1</b> Data</a></li>
<li class="chapter" data-level="3.2" data-path="outlier-detection.html"><a href="outlier-detection.html#outlier-detection-in-the-aggregated-level"><i class="fa fa-check"></i><b>3.2</b> Outlier detection in the aggregated level</a><ul>
<li class="chapter" data-level="3.2.1" data-path="outlier-detection.html"><a href="outlier-detection.html#boxplot"><i class="fa fa-check"></i><b>3.2.1</b> Boxplot</a></li>
<li class="chapter" data-level="3.2.2" data-path="outlier-detection.html"><a href="outlier-detection.html#median-absolute-deviation-mad"><i class="fa fa-check"></i><b>3.2.2</b> Median Absolute Deviation (MAD)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="outlier-detection.html"><a href="outlier-detection.html#correction-of-main-outlier"><i class="fa fa-check"></i><b>3.3</b> Correction of main outlier</a><ul>
<li class="chapter" data-level="3.3.1" data-path="outlier-detection.html"><a href="outlier-detection.html#locally-estimated-scatterplot-smoothing-loess"><i class="fa fa-check"></i><b>3.3.1</b> Locally Estimated Scatterplot Smoothing (LOESS)</a></li>
<li class="chapter" data-level="3.3.2" data-path="outlier-detection.html"><a href="outlier-detection.html#median-weighted-average"><i class="fa fa-check"></i><b>3.3.2</b> Median weighted average</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fishery: Trade Module</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec:workflow" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Trade data Workflow</h1>
<p>In this section, we show the fisheries trade workflow passing by the mapping commodities, outlier detection, and correction of the main outliers. The idea is show the methodology applied in each step using a small example.</p>
<div id="get-started-data" class="section level2">
<h2><span class="header-section-number">2.1</span> Get started data</h2>
<p>we selected the country Brazil to show the R module steps. First we get the data from <code>Tariff Line</code> source, and filter only the valid commodities. In this case, we remove the commodities that HS code start with <code>0301</code>. This removing rule was determined by the fishery team.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">no_imputation &lt;-<span class="st"> &quot;0301&quot;</span>; REPORTER &lt;-<span class="st"> &quot;76&quot;</span>
<span class="kw">get_working_data</span>(<span class="dt">.reporter =</span> REPORTER, <span class="dt">.local =</span> <span class="ot">TRUE</span>)
tldata &lt;-<span class="st"> </span>tldata[<span class="kw">substr</span>(hs, <span class="dv">1</span>, <span class="dv">4</span>) <span class="op">!=</span><span class="st"> </span>no_imputation]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(tldata)</code></pre></div>
<pre><code>##    year reporter partner flow           hs hsrep  value weight    qty
## 1: 2000       76      56    2 030629000000    H1    399     NA     NA
## 2: 2000       76      32    1 210390110000    H1 268359 197636 197636
## 3: 2000       76      32    1 210390110000    H1 310331 228406 228406
## 4: 2000       76      32    1 210390110000    H1 104457  83355  83355
## 5: 2000       76      32    1 210390110000    H1 294883 247896 247896
## 6: 2000       76      32    1 210390110000    H1 244719 210526 210526
##    qunit hslength  src
## 1:     1        8 unsd
## 2:     8        8 unsd
## 3:     8        8 unsd
## 4:     8        8 unsd
## 5:     8        8 unsd
## 6:     8        8 unsd</code></pre>
<p>There are many methods for outlier detection, for instance, model-based, quantiles methods, and deviation from average. However, in this task, we are manipulating the massive amount of heterogeneous data grouped in country and commodity class. Therefore, a general and straightforward method can be an excellent choice to perform outlier detection. Given this scenario, the Median Absolute Deviation (MAD) was adopted and applied for each commodity per year. The main idea of this strategy is to find outliers that are away from its median when compared in the same commodity.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="outlier-detection.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
